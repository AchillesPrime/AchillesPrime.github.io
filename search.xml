<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>SQL Foundation.B</title>
      <link href="/2018/09/30/SQL-Foundation-B/"/>
      <url>/2018/09/30/SQL-Foundation-B/</url>
      
        <content type="html"><![CDATA[<h2 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h2><ul><li>子查询<ul><li>嵌入在其他 SQL 语句中的 select 语句</li><li>本质<ul><li>多个select语句的嵌套</li></ul></li></ul></li></ul><h2 id="单行子查询"><a href="#单行子查询" class="headerlink" title="单行子查询"></a>单行子查询</h2><ul><li>返回一行一列给外部（主）SQL 语句</li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> teachers       <span class="token keyword">where</span>        wage <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token keyword">from</span> teachers<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students       <span class="token keyword">where</span>        specialty <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> specialty <span class="token keyword">from</span> students                            <span class="token keyword">where</span>                            name <span class="token operator">=</span> <span class="token string">'王天仪'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students       <span class="token keyword">where</span>        dob <span class="token operator">></span> <span class="token punctuation">(</span><span class="token keyword">select</span> dob <span class="token keyword">from</span> students                      <span class="token keyword">where</span>                      name <span class="token operator">=</span> <span class="token string">'王天仪'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ul><li>where<ul><li>子查询的结果作为主查询的查询条件</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> department_id <span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">"平均工资"</span> <span class="token keyword">from</span> teachers       <span class="token keyword">group</span> <span class="token keyword">by</span> department_id       <span class="token keyword">having</span>        <span class="token function">avg</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">from</span> teachers                            <span class="token keyword">group</span> <span class="token keyword">by</span> department_id<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ul><li>having<ul><li>子查询的结果作为主查询的分组条件</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students                       <span class="token keyword">where</span>                       sex <span class="token operator">=</span> <span class="token string">'男'</span><span class="token punctuation">)</span>       <span class="token keyword">where</span>        specialty <span class="token operator">=</span> <span class="token string">'计算机'</span><span class="token punctuation">;</span></code></pre><ul><li>from<ul><li>子查询的结果作为主查询的视图</li></ul></li></ul><h2 id="多行子查询"><a href="#多行子查询" class="headerlink" title="多行子查询"></a>多行子查询</h2><ul><li>返回多行一列给外部（主）SQL 语句</li><li>where 子句中必须使用多行比较符 in、any或all</li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> student_id <span class="token punctuation">,</span> name <span class="token keyword">from</span> students       <span class="token keyword">where</span>        student_id <span class="token operator">in</span>        <span class="token punctuation">(</span><span class="token keyword">select</span> student_id <span class="token keyword">from</span> students                <span class="token keyword">where</span>                name <span class="token operator">like</span> <span class="token string">'王%'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">select</span> course_id <span class="token punctuation">,</span> course_name <span class="token keyword">from</span> courses       <span class="token keyword">where</span>        course_id <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> course_id <span class="token keyword">from</span> student_grade<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ul><li><code>in</code><ul><li>匹配于子查询的任意一个值</li><li>结果为真，否则为假</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> teachers       <span class="token keyword">where</span>        wage <span class="token operator">&lt;</span> <span class="token keyword">any</span>       <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token keyword">from</span> teachers                <span class="token keyword">group</span> <span class="token keyword">by</span> department_id<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ul><li><p><code>any</code></p><ul><li>只要符合子查询结果的任意一个值</li><li>结果为真，否则为假</li><li><p><code>= any</code></p><ul><li>功能与IN操作符是完全一样的</li></ul></li><li><p><code>&gt; any</code></p><ul><li>比子查询中返回的最小结果还要大</li></ul></li><li><p><code>&lt; any</code></p><ul><li>比子查询中返回的最大结果要小</li></ul></li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> teachers       <span class="token keyword">where</span>        wage <span class="token operator">></span> <span class="token keyword">all</span>        <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token keyword">from</span> teachers                <span class="token keyword">group</span> <span class="token keyword">by</span> department_id<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ul><li><code>all</code><ul><li>必须符合子查询结果的所有值</li><li>结果为真，否则为假</li><li><code>&gt; all</code><ul><li>比子查询中返回的最大结果还要大</li></ul></li><li><code>&lt; all</code><ul><li>比子查询中返回的最小结果还要小</li></ul></li></ul></li></ul><h2 id="多列子查询"><a href="#多列子查询" class="headerlink" title="多列子查询"></a>多列子查询</h2><ul><li>返回一行多列或多行多列给外部（主）SQL 语句</li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students       <span class="token keyword">where</span>        <span class="token punctuation">(</span>specialty <span class="token punctuation">,</span> dob<span class="token punctuation">)</span> <span class="token operator">=</span>       <span class="token punctuation">(</span><span class="token keyword">select</span> specialty <span class="token punctuation">,</span> dob <span class="token keyword">from</span> students                <span class="token keyword">where</span>                name <span class="token operator">=</span> <span class="token string">'王天仪'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ul><li>返回一行多列<ul><li>参照单行子查询</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> teachers       <span class="token keyword">where</span>        <span class="token punctuation">(</span>department_id <span class="token punctuation">,</span> wage<span class="token punctuation">)</span> <span class="token operator">in</span>        <span class="token punctuation">(</span><span class="token keyword">select</span> department_id <span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token keyword">from</span> teachers                <span class="token keyword">group</span> <span class="token keyword">by</span> department_id<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ul><li>返回多行多列<ul><li>参照多行子查询</li></ul></li></ul><h2 id="相关子查询"><a href="#相关子查询" class="headerlink" title="相关子查询"></a>相关子查询</h2><ul><li>子查询引用了外部（主）查询中的一列或多列<ul><li>子查询不能在外部（主）查询之前求值</li><li>需要依靠外部查询才能获得值</li><li>执行过程：<ul><li>1、<ul><li>从外层查询中取出一个元组，将元组相关列的值传给内层查询</li></ul></li><li>2、<ul><li>执行内层查询，得到子查询操作的值</li></ul></li><li>3、<ul><li>外查询根据子查询返回的结果或结果集得到满足条件的行</li></ul></li><li>4、<ul><li>然后外层查询取出下一个元组重复做步骤1-3，直到外层的元组全部处理完毕</li></ul></li></ul></li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> teachers t1       <span class="token keyword">where</span>        wage <span class="token operator">></span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token keyword">from</span> teachers t2                      <span class="token keyword">where</span>                       t2<span class="token punctuation">.</span>department_id <span class="token operator">=</span> t1<span class="token punctuation">.</span>department_id<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ul><li>外部（主）查询和子查询通过 department_id 相关联<ul><li>外部（主）查询从 teacher 表中检索出所有行</li><li>并传递给子查询</li><li>子查询接受外部（主）查询传递过来的每一行数据</li><li>并对满足 t2.department_id = t1.department_id 的每一部门教师计算平均工资</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> course_id <span class="token punctuation">,</span> course_name <span class="token keyword">from</span> courses <span class="token number">c</span>       <span class="token keyword">where</span>        <span class="token keyword">exists</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">2</span> <span class="token keyword">from</span> student_grade sg                      <span class="token keyword">where</span>                       sg<span class="token punctuation">.</span>course_id <span class="token operator">=</span> <span class="token number">c</span><span class="token punctuation">.</span>course_id<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ul><li><code>exists</code></li><li>已被选学的课程<ul><li>用于检查子查询返回的记录行是否存在</li><li>分析执行步骤：<ul><li>1、<ul><li>先执行外部查询</li><li>SQL&gt; select course_id ,course_name from courses c</li></ul></li><li>2、<ul><li>外部查询的每一条数据对比一次子查询</li><li>第一次比较<ul><li>10101 计算机组成原理</li><li>只要 exists 后对比的结果返回true </li><li>则列出 10101 计算机组成原理</li></ul></li></ul></li><li>3、<ul><li>同理外部查询的 course_id , course_name 还剩下8项</li><li>一一和内部查询的 student_id , course_id , grade 比较</li><li>最后得出结果</li><li>不管第二个 select 用 * 号还是 student_id , course_id , grade 项</li><li>都不会影响整个相关查询的结果，</li><li>外部查询的项和内部查询项对比时只会看是否为ture，如果为ture则列出结果</li><li>用 select 2 不用 select *</li><li>因为用 select * 要查数据字典所以会慢点</li></ul></li></ul></li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> course_id <span class="token punctuation">,</span> course_name <span class="token keyword">from</span> courses <span class="token number">c</span>       <span class="token keyword">where</span>        <span class="token operator">not</span> <span class="token keyword">exists</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">2</span> <span class="token keyword">from</span> student_grade sg                         <span class="token keyword">where</span>                          sg<span class="token punctuation">.</span>course_id <span class="token operator">=</span> <span class="token number">c</span><span class="token punctuation">.</span>course_id<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ul><li><code>not exists</code></li><li>未被选学的课程<ul><li>用于检查子查询返回的记录行是否不存在</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> department_id <span class="token punctuation">,</span> department_name <span class="token keyword">from</span> departments       <span class="token keyword">where</span>        department_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> department_id <span class="token keyword">from</span> teachers<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ul><li><code>in</code><ul><li>已经安排教师的系部</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> department_id <span class="token punctuation">,</span> department_name <span class="token keyword">from</span> departments       <span class="token keyword">where</span>        department_id <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> department_id <span class="token keyword">from</span> teachers<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ul><li><code>not in</code><ul><li>没有安排教师的系部</li></ul></li></ul><h2 id="嵌套子查询"><a href="#嵌套子查询" class="headerlink" title="嵌套子查询"></a>嵌套子查询</h2><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students                       <span class="token keyword">where</span>                       specialty <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> specialty <span class="token keyword">from</span> students                                           <span class="token keyword">where</span>                                           name <span class="token operator">=</span> <span class="token string">'王天仪'</span><span class="token punctuation">)</span>               <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ul><li>嵌套深度允许高达255级</li></ul><h2 id="集合操作"><a href="#集合操作" class="headerlink" title="集合操作"></a>集合操作</h2><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> course_id <span class="token punctuation">,</span> course_name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> courses       <span class="token keyword">union</span> <span class="token keyword">all</span><span class="token keyword">select</span> minor_id <span class="token punctuation">,</span> minor_name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> minors<span class="token punctuation">;</span><span class="token keyword">select</span> course_id <span class="token punctuation">,</span> course_name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> courses       <span class="token keyword">union</span> <span class="token keyword">all</span><span class="token keyword">select</span> minor_id <span class="token punctuation">,</span> minor_name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> minors       <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students        <span class="token keyword">where</span>        specialty <span class="token operator">=</span> <span class="token string">'计算机'</span>       <span class="token keyword">union</span> <span class="token keyword">all</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students        <span class="token keyword">where</span>        sex <span class="token operator">=</span> <span class="token string">'男'</span><span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students        <span class="token keyword">where</span>        specialty <span class="token operator">=</span> <span class="token string">'计算机'</span>       <span class="token keyword">union</span> <span class="token keyword">all</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students        <span class="token keyword">where</span>        sex <span class="token operator">=</span> <span class="token string">'男'</span>       <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">1</span><span class="token punctuation">;</span></code></pre><ul><li><code>union all</code><ul><li>获取两个查询结果的并集</li><li>不取消重复行</li><li>不排序</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> course_id <span class="token punctuation">,</span> course_name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> courses       <span class="token keyword">union</span><span class="token keyword">select</span> minor_id <span class="token punctuation">,</span> minor_name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> minors<span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students        <span class="token keyword">where</span>        specialty <span class="token operator">=</span> <span class="token string">'计算机'</span>       <span class="token keyword">union</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students        <span class="token keyword">where</span>        sex <span class="token operator">=</span> <span class="token string">'男'</span><span class="token punctuation">;</span></code></pre><ul><li><code>union</code><ul><li>获取两个查询结果的并集</li><li>自动取消重复行</li><li>以第一列排序</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> course_id <span class="token punctuation">,</span> course_name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> courses       <span class="token keyword">intersect</span><span class="token keyword">select</span> minor_id <span class="token punctuation">,</span> minor_name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> minors<span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students        <span class="token keyword">where</span>        specialty <span class="token operator">=</span> <span class="token string">'计算机'</span>       <span class="token keyword">intersect</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students        <span class="token keyword">where</span>        sex <span class="token operator">=</span> <span class="token string">'男'</span><span class="token punctuation">;</span></code></pre><ul><li><code>intersect</code><ul><li>获取两个查询结果的交集</li><li>第一个查询结果集中存在</li><li>第二个查询结果集中存在</li><li>以第一列排序</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> course_id <span class="token punctuation">,</span> course_name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> courses       minus<span class="token keyword">select</span> minor_id <span class="token punctuation">,</span> minor_name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> minors<span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students        <span class="token keyword">where</span>        specialty <span class="token operator">=</span> <span class="token string">'计算机'</span>       minus<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students        <span class="token keyword">where</span>        sex <span class="token operator">=</span> <span class="token string">'男'</span><span class="token punctuation">;</span></code></pre><ul><li><code>minus</code><ul><li>获取两个集合的差集</li><li>第一个查询结果集中存在</li><li>第二个查询结果集不存在</li><li>以第一列排序</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token punctuation">(</span><span class="token keyword">select</span> course_id <span class="token punctuation">,</span> course_name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> courses       <span class="token keyword">intersect</span><span class="token keyword">select</span> minor_id <span class="token punctuation">,</span> minor_name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> minors<span class="token punctuation">)</span>       <span class="token keyword">union</span><span class="token keyword">select</span> course_id <span class="token punctuation">,</span> course_name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> courses2<span class="token punctuation">;</span><span class="token keyword">select</span> course_id <span class="token punctuation">,</span> course_name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> courses       <span class="token keyword">union</span><span class="token punctuation">(</span><span class="token keyword">select</span> minor_id <span class="token punctuation">,</span> minor_name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> minors       <span class="token keyword">intersect</span><span class="token keyword">select</span> course_id <span class="token punctuation">,</span> course_name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> courses2<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ul><li>组合使用集合操作符<ul><li>具有相同的优先级</li><li>从左至右</li><li>括号内的集合操作具有较高的优先级</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> course_id <span class="token punctuation">,</span> course_name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> courses       <span class="token keyword">union</span><span class="token keyword">select</span> minor_id <span class="token punctuation">,</span> minor_name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> minors       <span class="token keyword">order</span> <span class="token keyword">by</span> course_name<span class="token punctuation">;</span><span class="token keyword">select</span> course_id <span class="token punctuation">,</span> course_name <span class="token keyword">as</span> name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> courses       <span class="token keyword">union</span><span class="token keyword">select</span> minor_id <span class="token punctuation">,</span> minor_name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> minors       <span class="token keyword">order</span> <span class="token keyword">by</span> name<span class="token punctuation">;</span><span class="token keyword">select</span> course_id <span class="token punctuation">,</span> course_name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> courses       <span class="token keyword">union</span><span class="token keyword">select</span> minor_id <span class="token punctuation">,</span> minor_name <span class="token punctuation">,</span> credit_hour <span class="token keyword">from</span> minors       <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">2</span><span class="token punctuation">;</span></code></pre><ul><li>集合操作符只能有一个 order by 子句<ul><li>必须将它放在语句的末尾</li><li>排序的3种较好的选择<ul><li>第一个 select 中的列名</li><li>第一个 select 中的列别名</li><li>集合操作结果集中的位置编号</li></ul></li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> course_name <span class="token keyword">as</span> <span class="token string">"111"</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>credit_hour<span class="token punctuation">)</span> <span class="token keyword">from</span> courses       <span class="token keyword">where</span>        credit_hour <span class="token operator">></span> <span class="token number">3</span>       <span class="token keyword">group</span> <span class="token keyword">by</span> course_name       <span class="token keyword">union</span><span class="token keyword">select</span> minor_name <span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>credit_hour<span class="token punctuation">)</span> <span class="token keyword">from</span> minors       <span class="token keyword">where</span>        credit_hour <span class="token operator">></span> <span class="token number">2</span>       <span class="token keyword">group</span> <span class="token keyword">by</span> minor_name<span class="token punctuation">;</span></code></pre><ul><li>为某个列指定一个新的名称（列别名），必须在集合操作的第一个select子句中指定</li></ul><h2 id="集合操作中的数据类型"><a href="#集合操作中的数据类型" class="headerlink" title="集合操作中的数据类型"></a>集合操作中的数据类型</h2><pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> table_1 <span class="token punctuation">(</span>       column_11 number<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>       column_12 varchar2<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">create</span> <span class="token keyword">table</span> table_2 <span class="token punctuation">(</span>       column_21 number<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>       column_22 varchar2<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> table_1<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">111</span> <span class="token punctuation">,</span> <span class="token string">'aa'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> table_1<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">222</span> <span class="token punctuation">,</span> <span class="token string">'bb'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> table_1<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">333</span> <span class="token punctuation">,</span> <span class="token string">'cc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> table_2<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">44444</span> <span class="token punctuation">,</span> <span class="token string">'dddd'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> table_2<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">55555</span> <span class="token punctuation">,</span> <span class="token string">'eeee'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> table_2<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">66666</span> <span class="token punctuation">,</span> <span class="token string">'ffff'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> table_1<span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> table_2<span class="token punctuation">;</span>delet <span class="token keyword">from</span> table_1<span class="token punctuation">;</span>delet <span class="token keyword">from</span> table_2<span class="token punctuation">;</span><span class="token keyword">drop</span> <span class="token keyword">table</span> table_1<span class="token punctuation">;</span><span class="token keyword">drop</span> <span class="token keyword">table</span> table_2<span class="token punctuation">;</span><span class="token keyword">select</span> column_11 <span class="token punctuation">,</span> column_12 <span class="token keyword">from</span> table_1       <span class="token keyword">union</span><span class="token keyword">select</span> column_21 <span class="token punctuation">,</span> column_22 <span class="token keyword">from</span> table_2<span class="token punctuation">;</span></code></pre><ul><li>集合操作中的数据类型相同，长度不同<ul><li>文本<ul><li>让所有数据的长度等于最长列的长度</li></ul></li><li>数值<ul><li>让所有数据的长度保持所有数值都允许的长度</li></ul></li><li>日期<ul><li>日期列的数据类型只有一个，不存在数据类型相同但长度不同的情况</li></ul></li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> table_3 <span class="token punctuation">(</span>       column_31 number<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>       column_32 varchar2<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>       column_33 varchar2<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">create</span> <span class="token keyword">table</span> table_4 <span class="token punctuation">(</span>       column_41 varchar2<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>       column_42 number<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>       column_43 <span class="token keyword">date</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> table_3<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">111</span> <span class="token punctuation">,</span><span class="token string">'aa'</span> <span class="token punctuation">,</span> <span class="token string">'aaaaaaaaaa'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> table_3<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">222</span> <span class="token punctuation">,</span><span class="token string">'bb'</span> <span class="token punctuation">,</span> <span class="token string">'bbbbbbbbbb'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> table_3<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">333</span> <span class="token punctuation">,</span><span class="token string">'cc'</span> <span class="token punctuation">,</span> <span class="token string">'cccccccccc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> table_4<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'ddd'</span> <span class="token punctuation">,</span><span class="token number">44</span> <span class="token punctuation">,</span> <span class="token string">'07-5月-1998'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> table_4<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'eee'</span> <span class="token punctuation">,</span><span class="token number">55</span> <span class="token punctuation">,</span> <span class="token string">'07-5月-1998'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> table_4<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'fff'</span> <span class="token punctuation">,</span><span class="token number">66</span> <span class="token punctuation">,</span> <span class="token string">'07-5月-1998'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> table_3<span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> table_4<span class="token punctuation">;</span>delet <span class="token keyword">from</span> table_3<span class="token punctuation">;</span>delet <span class="token keyword">from</span> table_4<span class="token punctuation">;</span><span class="token keyword">drop</span> <span class="token keyword">table</span> table_3<span class="token punctuation">;</span><span class="token keyword">drop</span> <span class="token keyword">table</span> table_4<span class="token punctuation">;</span><span class="token keyword">select</span> to_char <span class="token punctuation">(</span>column_31<span class="token punctuation">)</span> <span class="token punctuation">,</span>        column_32 <span class="token punctuation">,</span>        column_33 <span class="token keyword">from</span> table_3       <span class="token keyword">union</span><span class="token keyword">select</span> column_41 <span class="token punctuation">,</span>        to_char <span class="token punctuation">(</span>column_42<span class="token punctuation">)</span> <span class="token punctuation">,</span>        to_char <span class="token punctuation">(</span>column_43 <span class="token punctuation">,</span> <span class="token string">'yyyy-mm-dd'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> table_4<span class="token punctuation">;</span></code></pre><ul><li>集合操作中的数据类型不同<ul><li>通过 to_char() 函数将所有数字型或日期型转换为文本型<ul><li>查询前的设置<ul><li>SQL&gt; column column_31 format a10;<ul><li>字段column_31输出时的格式设置为文本型，且占10个字符宽度</li></ul></li><li>SQL&gt; column column_32 format a10;<ul><li>字段column_32输出时的格式设置为文本型，且占10个字符宽度</li></ul></li><li>SQL&gt; column column_33 format a10;<ul><li>字段column_33输出时的格式设置为文本型，且占10个字符宽度</li></ul></li></ul></li></ul></li></ul></li></ul><pre class=" language-sql"><code class="language-sql"></code></pre><pre class=" language-sql"><code class="language-sql"></code></pre><pre class=" language-sql"><code class="language-sql"></code></pre><pre class=" language-sql"><code class="language-sql"></code></pre><pre class=" language-sql"><code class="language-sql"></code></pre><pre class=" language-sql"><code class="language-sql"></code></pre><pre class=" language-sql"><code class="language-sql"></code></pre><pre class=" language-sql"><code class="language-sql"></code></pre><pre class=" language-sql"><code class="language-sql"></code></pre><pre class=" language-sql"><code class="language-sql"></code></pre><pre class=" language-sql"><code class="language-sql"></code></pre><pre class=" language-sql"><code class="language-sql"></code></pre><pre class=" language-sql"><code class="language-sql"></code></pre><pre class=" language-sql"><code class="language-sql"></code></pre><pre class=" language-sql"><code class="language-sql"></code></pre><pre class=" language-sql"><code class="language-sql"></code></pre><pre class=" language-sql"><code class="language-sql"></code></pre><pre class=" language-sql"><code class="language-sql"></code></pre><pre class=" language-sql"><code class="language-sql"></code></pre><pre class=" language-sql"><code class="language-sql"></code></pre><pre class=" language-sql"><code class="language-sql"></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Database </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>SQL Foundation.A</title>
      <link href="/2018/09/30/SQL-Foundation-A/"/>
      <url>/2018/09/30/SQL-Foundation-A/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><ul><li>SQL Server 是美国 Microsoft 公司推出的关系型数据库管理系统（RDBMS）</li><li>Oracle 是美国 Oracle 公司推出的关系型数据库管理系统</li><li>MySQL 关系型数据库管理系统，由瑞典 MySQL AB 公司开发，目前属于 Oracle 旗下产品</li><li>Oracle 11g<ul><li>帮助企业管理企业信息</li><li>更深入地洞察业务状况并做出调整</li><li>适应不断变化的竞争环境</li></ul></li></ul><h2 id="范式"><a href="#范式" class="headerlink" title="范式"></a>范式</h2><ul><li>关系型数据库中要满足的一定要求</li><li>规范化有助于消除表中数据的冗余和不一致性</li><li>为了充分发挥 SQL 的作用，往往是转化到第三范式</li><li>规范化的一个简单原则：所有的属性必须完全依赖于主关键字列</li><li>第一范式（1NF）<ul><li>所有属性都是不可分割的</li><li>表中的每一行每一列均有一个值，永远不会是一组值</li></ul></li><li>第二范式（2NF）<ul><li>每一个不是关键字一部分的列都依赖于关键字</li><li>如果函数仅依赖于一部分主码（主码有若干个）来确定信息，则违反了第二范式</li></ul></li><li>第三范式 （3NF）<ul><li>每个非关键字列都独立于其他非关键字列，并依赖于关键字</li><li>违反第三范式经常产生严重后果，必须予以纠正</li></ul></li></ul><h2 id="SQL、PL-SQL、SQL-PLUS"><a href="#SQL、PL-SQL、SQL-PLUS" class="headerlink" title="SQL、PL/SQL、SQL*PLUS"></a>SQL、PL/SQL、SQL*PLUS</h2><ul><li>SQL（结构化查询语言）是世界上最流行的、标准化的数据库语言<ul><li>4GL ，第四代语言</li><li>用于建立、存储、修改、检索和管理关系型数据库中的数据</li><li>非过程化程度相当高，用户只需在程序中指出要做什么就可以了</li><li>在 BASIC、C++、Java 等语言中<ul><li>3GL ，第三代语言</li><li>需要把对数据进行处理的每一过程都在程序中表达清楚</li><li>否则程序就不能正确反映用户的要求与意图</li><li>这样的语言称之为过程化语言</li></ul></li></ul></li><li>PL/SQL 是一种过程化语言，是对SQL的扩充<ul><li>3GL ，第三代语言</li><li>把SQL语言的特点和第三代语言（3GL）的强大功能结合在一起</li><li>可以用来实现比较复杂的业务逻辑，成为设计复杂数据库应用程序的有力工具</li></ul></li><li>SQL*Plus 是 Oracle 数据库的开发工具<ul><li>在 SQL*Plus 环境中可以编辑、调试、运行 SQL 语言语句和 PL/SQL 程序</li><li>对英文字母大小写不敏感</li><li>增加程序的可读性：<ul><li>关键字大写</li><li>标识符小写</li></ul></li><li>SQL&gt; 是SQL*Plus的提示符</li><li>退出操作<ul><li>SQL&gt;exit（出口、通道）</li><li>SQL&gt;quit（辞职、中断）</li></ul></li><li>在SQL*Plus 中执行 SQL 语句，语句末尾需要加上分号 <code>；</code></li><li>在SQL*Plus 中执行 PL/SQL 程序，先需执行 <code>set serveroutput on</code><ul><li>且最后一条语句的下一行需要输入斜杠 <code>/</code></li></ul></li></ul></li></ul><h2 id="基本数据类型"><a href="#基本数据类型" class="headerlink" title="基本数据类型"></a>基本数据类型</h2><ul><li>Oracle 11g 主要的3种数据类型：基本、集合、引用。</li></ul><ul><li>char：定长字符串，必须指定长度，1（默认）~255字节</li><li>varchar2：变长字符串，必须指定最大字节数，最大长度为2000字节</li><li>number：存储零、正负定点数或浮点数，最大精度38位<ul><li>定点数据类型<code>number（p,s）</code></li><li>p：总的有效数字的位数，精度范围1~38</li><li>s：小数点右边数字位，范围-84~127</li></ul></li></ul><h2 id="日期格式"><a href="#日期格式" class="headerlink" title="日期格式"></a>日期格式</h2><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> sysdate <span class="token keyword">from</span> dual<span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token keyword">user</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token operator">+</span><span class="token number">2</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span><span class="token keyword">select</span> to_char<span class="token punctuation">(</span>sysdate<span class="token punctuation">,</span><span class="token string">'yyyy-mm-dd hh24:mi:ss'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span></code></pre><ul><li><code>select sysdate from dual</code><ul><li>显示 Oracle 系统日期</li></ul></li><li>sysdate 为 Oracle 系统当前服务器的时间<ul><li>dual 是一个单行单列的虚拟表<ul><li>dual 表数据类型为 varchar2(1)</li><li>Oracle 的内部逻辑保证 dual 表中永远只有一条数据 <code>X</code></li><li>dual 可用来选择系统变量或求一个表达式的值</li></ul></li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> sysdate <span class="token punctuation">,</span> to_char <span class="token punctuation">(</span>sysdate <span class="token punctuation">,</span> <span class="token string">'yyyy-mm-dd'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span><span class="token keyword">select</span> sysdate <span class="token punctuation">,</span> to_char <span class="token punctuation">(</span>sysdate <span class="token punctuation">,</span> <span class="token string">'yyyy/mm/dd'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span><span class="token keyword">select</span> sysdate <span class="token punctuation">,</span> to_char <span class="token punctuation">(</span>sysdate <span class="token punctuation">,</span> <span class="token string">'yyyymmdd'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span><span class="token keyword">select</span> sysdate <span class="token punctuation">,</span> to_char <span class="token punctuation">(</span>sysdate <span class="token punctuation">,</span> <span class="token string">'yyyymmdd hh24:mi:ss'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span><span class="token keyword">select</span> sysdate <span class="token punctuation">,</span> to_char <span class="token punctuation">(</span>sysdate <span class="token punctuation">,</span> <span class="token string">'yyyy'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span><span class="token keyword">select</span> sysdate <span class="token punctuation">,</span> to_char <span class="token punctuation">(</span>sysdate <span class="token punctuation">,</span> <span class="token string">'mm'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span><span class="token keyword">select</span> sysdate <span class="token punctuation">,</span> to_char <span class="token punctuation">(</span>sysdate <span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span><span class="token keyword">select</span> sysdate <span class="token punctuation">,</span> to_char <span class="token punctuation">(</span>sysdate <span class="token punctuation">,</span> <span class="token string">'mi'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span></code></pre><ul><li>to_char ()函数<ul><li>将时间日期按照指定的格式输出，得到的是字符串，而非date类型</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> sysdate <span class="token punctuation">,</span> to_date <span class="token punctuation">(</span><span class="token string">'20170615'</span> <span class="token punctuation">,</span> <span class="token string">'yyyy-mm-dd'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span><span class="token keyword">select</span> sysdate <span class="token punctuation">,</span> to_date <span class="token punctuation">(</span><span class="token string">'20170615'</span> <span class="token punctuation">,</span> <span class="token string">'yyyy/mm/dd'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span><span class="token keyword">select</span> sysdate <span class="token punctuation">,</span> to_date <span class="token punctuation">(</span><span class="token string">'20170615'</span> <span class="token punctuation">,</span> <span class="token string">'yyyymmdd'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span><span class="token keyword">select</span> sysdate <span class="token punctuation">,</span> to_date <span class="token punctuation">(</span><span class="token string">'20170615'</span> <span class="token punctuation">,</span> <span class="token string">'yyyy-mm-dd hh24:mi:ss'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span></code></pre><ul><li>to_date()函数<ul><li>将字符串转换为具体指定的时间日期格式</li></ul></li></ul><ul><li>如果安装的客户端是中文环境，格式 mon 就不能用英文的月份写法<ul><li>必须用中文的 <code>数字-数字+月-数字</code></li><li>或者使用 <code>to_date(&#39;1998-05-07&#39;,&#39;yyyy-mm-dd&#39;)</code></li></ul></li></ul><h2 id="定义表结构"><a href="#定义表结构" class="headerlink" title="定义表结构"></a>定义表结构</h2><pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> students <span class="token punctuation">(</span>       student_id number<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>                  <span class="token keyword">constraint</span> student_pk <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>       monitor_id number<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>       name varchar2<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>             <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>       sex varchar2<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>           <span class="token keyword">constraint</span> sex_chk <span class="token keyword">check</span><span class="token punctuation">(</span>sex <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>       dob <span class="token keyword">date</span><span class="token punctuation">,</span>       specialty varchar2<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>   <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> departments <span class="token punctuation">(</span>       department_id number<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>                     <span class="token keyword">constraint</span> department_pk <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>       department_name varchar2<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>                        <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>       address varchar2<span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> teachers <span class="token punctuation">(</span>       teacher_id number<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>                  <span class="token keyword">constraint</span> teacher_pk <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>       name varchar2<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>             <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>       title varchar2<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>       hire_date <span class="token keyword">date</span>                  <span class="token keyword">default</span> sysdate<span class="token punctuation">,</span>       bonus number<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>       wage number<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>       department_id number<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>                     <span class="token keyword">constraint</span> teachers_fk_departments                     <span class="token keyword">references</span> departments<span class="token punctuation">(</span>department_id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> courses<span class="token punctuation">(</span>       course_id number<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>                 <span class="token keyword">constraint</span> course_pk <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>       course_name varchar2<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>                    <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>       credit_hour number<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> student_grade<span class="token punctuation">(</span>       student_id number<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>                  <span class="token keyword">constraint</span> student_grade_fk_students                  <span class="token keyword">references</span> students<span class="token punctuation">(</span>student_id<span class="token punctuation">)</span><span class="token punctuation">,</span>       course_id number<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>                 <span class="token keyword">constraint</span> student_grade_fk_courses                 <span class="token keyword">references</span> courses<span class="token punctuation">(</span>course_id<span class="token punctuation">)</span><span class="token punctuation">,</span>       score number<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> grades<span class="token punctuation">(</span>       garde_id number<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>                <span class="token keyword">constraint</span> grade_ok <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>       low_score number<span class="token punctuation">(</span><span class="token number">4</span> <span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>       high_score number<span class="token punctuation">(</span><span class="token number">4</span> <span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>       grade varchar2<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> minors<span class="token punctuation">(</span>       minor_id number<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>                <span class="token keyword">constraint</span> minor_pk <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>       minor_name varchar2<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>                   <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>       credit_hour number<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> courses2<span class="token punctuation">(</span>       course_id number<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>                 <span class="token keyword">constraint</span> course2_pk <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>       course_name varchar2<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>                    <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>       credit_hour number<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> student_computer<span class="token punctuation">(</span>       student_id number<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>                  <span class="token keyword">constraint</span> student_computer_pk <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>       monitor_id number<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>       name varchar2<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>             <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>       sex varchar2<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>       dob <span class="token keyword">date</span><span class="token punctuation">,</span>       specialty varchar2<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="插入表数据"><a href="#插入表数据" class="headerlink" title="插入表数据"></a>插入表数据</h2><pre class=" language-sql"><code class="language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> students <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10101</span> <span class="token punctuation">,</span> <span class="token boolean">null</span> <span class="token punctuation">,</span> <span class="token string">'王晓芳'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span> <span class="token punctuation">,</span> <span class="token string">'07-5月-1988'</span> <span class="token punctuation">,</span> <span class="token string">'计算机'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> students <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10205</span> <span class="token punctuation">,</span> <span class="token boolean">null</span> <span class="token punctuation">,</span> <span class="token string">'李秋枫'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span> <span class="token punctuation">,</span> <span class="token string">'25-11月-1990'</span> <span class="token punctuation">,</span> <span class="token string">'自动化'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> students<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10102</span> <span class="token punctuation">,</span> <span class="token number">10101</span> <span class="token punctuation">,</span> <span class="token string">'刘春苹'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span> <span class="token punctuation">,</span> <span class="token string">'12-8月-1991'</span> <span class="token punctuation">,</span> <span class="token string">'计算机'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> students<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10301</span> <span class="token punctuation">,</span> <span class="token boolean">null</span> <span class="token punctuation">,</span> <span class="token string">'高山'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span> <span class="token punctuation">,</span> <span class="token string">'08-10月-1990'</span> <span class="token punctuation">,</span> <span class="token string">'机电工程'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> students<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10207</span> <span class="token punctuation">,</span> <span class="token number">10205</span> <span class="token punctuation">,</span> <span class="token string">'王刚'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span> <span class="token punctuation">,</span> <span class="token string">'03-4月-1987'</span> <span class="token punctuation">,</span> <span class="token string">'自动化'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> students<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10112</span> <span class="token punctuation">,</span> <span class="token number">10101</span> <span class="token punctuation">,</span> <span class="token string">'张纯玉'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span> <span class="token punctuation">,</span> <span class="token string">'21-7月-1989'</span> <span class="token punctuation">,</span> <span class="token string">'计算机'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> students<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10318</span> <span class="token punctuation">,</span> <span class="token number">10301</span> <span class="token punctuation">,</span> <span class="token string">'张冬云'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span> <span class="token punctuation">,</span> <span class="token string">'26-12月-1989'</span> <span class="token punctuation">,</span> <span class="token string">'机电工程'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> students<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10103</span> <span class="token punctuation">,</span> <span class="token number">10101</span> <span class="token punctuation">,</span> <span class="token string">'王天仪'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span> <span class="token punctuation">,</span> <span class="token string">'26-12月-1989'</span> <span class="token punctuation">,</span> <span class="token string">'计算机'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> students<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10201</span> <span class="token punctuation">,</span> <span class="token number">10205</span> <span class="token punctuation">,</span> <span class="token string">'赵风雨'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span> <span class="token punctuation">,</span> <span class="token string">'25-10月-1990'</span> <span class="token punctuation">,</span> <span class="token string">'自动化'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> students<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10105</span> <span class="token punctuation">,</span> <span class="token number">10101</span> <span class="token punctuation">,</span> <span class="token string">'韩刘'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span> <span class="token punctuation">,</span> <span class="token string">'3-8月-1991'</span> <span class="token punctuation">,</span> <span class="token string">'计算机'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> students<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10311</span> <span class="token punctuation">,</span> <span class="token number">10301</span> <span class="token punctuation">,</span> <span class="token string">'张杨'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span> <span class="token punctuation">,</span> <span class="token string">'08-5月-1990'</span> <span class="token punctuation">,</span> <span class="token string">'机电工程'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> students<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10213</span> <span class="token punctuation">,</span> <span class="token number">10205</span> <span class="token punctuation">,</span> <span class="token string">'高淼'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span> <span class="token punctuation">,</span> <span class="token string">'11-3月-1987'</span> <span class="token punctuation">,</span> <span class="token string">'自动化'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> students<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10212</span> <span class="token punctuation">,</span> <span class="token number">10205</span> <span class="token punctuation">,</span> <span class="token string">'欧阳春岚'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span> <span class="token punctuation">,</span> <span class="token string">'12-3月-1989'</span> <span class="token punctuation">,</span> <span class="token string">'自动化'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> students<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10314</span> <span class="token punctuation">,</span> <span class="token number">10301</span> <span class="token punctuation">,</span> <span class="token string">'赵迪帆'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span> <span class="token punctuation">,</span> <span class="token string">'22-9月-1989'</span> <span class="token punctuation">,</span> <span class="token string">'机电工程'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> students<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10312</span> <span class="token punctuation">,</span> <span class="token number">10301</span> <span class="token punctuation">,</span> <span class="token string">'白菲菲'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span> <span class="token punctuation">,</span> <span class="token string">'07-5月-1988'</span> <span class="token punctuation">,</span> <span class="token string">'机电工程'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> students<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10328</span> <span class="token punctuation">,</span> <span class="token number">10301</span> <span class="token punctuation">,</span> <span class="token string">'曾程程'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span> <span class="token punctuation">,</span> <span class="token boolean">null</span> <span class="token punctuation">,</span> <span class="token string">'机电工程'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> students<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10128</span> <span class="token punctuation">,</span> <span class="token number">10101</span> <span class="token punctuation">,</span> <span class="token string">'白昕'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span> <span class="token punctuation">,</span> <span class="token boolean">null</span> <span class="token punctuation">,</span> <span class="token string">'计算机'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> students<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10228</span> <span class="token punctuation">,</span> <span class="token number">10205</span> <span class="token punctuation">,</span> <span class="token string">'林寒紫'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span> <span class="token punctuation">,</span> <span class="token boolean">null</span> <span class="token punctuation">,</span> <span class="token string">'自动化'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class=" language-sql"><code class="language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> departments<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">101</span> <span class="token punctuation">,</span> <span class="token string">'信息工程'</span> <span class="token punctuation">,</span> <span class="token string">'1号教学楼'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> departments<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">102</span> <span class="token punctuation">,</span> <span class="token string">'电气工程'</span> <span class="token punctuation">,</span> <span class="token string">'2号教学楼'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> departments<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">103</span> <span class="token punctuation">,</span> <span class="token string">'机电工程'</span> <span class="token punctuation">,</span> <span class="token string">'3号教学楼'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> departments<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">104</span> <span class="token punctuation">,</span> <span class="token string">'工商管理'</span> <span class="token punctuation">,</span> <span class="token string">'4号教学楼'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class=" language-sql"><code class="language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> teachers<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10101</span> <span class="token punctuation">,</span> <span class="token string">'王彤'</span> <span class="token punctuation">,</span> <span class="token string">'教授'</span> <span class="token punctuation">,</span> <span class="token string">'01-9月-1990'</span> <span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token punctuation">,</span> <span class="token number">3000</span> <span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> teachers<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10104</span> <span class="token punctuation">,</span> <span class="token string">'孔世杰'</span> <span class="token punctuation">,</span> <span class="token string">'副教授'</span> <span class="token punctuation">,</span> <span class="token string">'06-7月-1994'</span> <span class="token punctuation">,</span> <span class="token number">800</span> <span class="token punctuation">,</span> <span class="token number">2700</span> <span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> teachers<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10103</span> <span class="token punctuation">,</span> <span class="token string">'邹人文'</span> <span class="token punctuation">,</span> <span class="token string">'讲师'</span> <span class="token punctuation">,</span> <span class="token string">'21-1月-1996'</span> <span class="token punctuation">,</span> <span class="token number">600</span> <span class="token punctuation">,</span> <span class="token number">2400</span> <span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> teachers<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10106</span> <span class="token punctuation">,</span> <span class="token string">'韩冬梅'</span> <span class="token punctuation">,</span> <span class="token string">'助教'</span> <span class="token punctuation">,</span> <span class="token string">'01-8月-2002'</span> <span class="token punctuation">,</span> <span class="token number">500</span> <span class="token punctuation">,</span> <span class="token number">1800</span> <span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> teachers<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10210</span> <span class="token punctuation">,</span> <span class="token string">'杨文化'</span> <span class="token punctuation">,</span> <span class="token string">'教授'</span> <span class="token punctuation">,</span> <span class="token string">'03-10月-1989'</span> <span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token punctuation">,</span> <span class="token number">3100</span> <span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> teachers<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10206</span> <span class="token punctuation">,</span> <span class="token string">'崔天'</span> <span class="token punctuation">,</span> <span class="token string">'助教'</span> <span class="token punctuation">,</span> <span class="token string">'05-9月-2000'</span> <span class="token punctuation">,</span> <span class="token number">500</span> <span class="token punctuation">,</span> <span class="token number">1900</span> <span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> teachers<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10209</span> <span class="token punctuation">,</span> <span class="token string">'孙晴碧'</span> <span class="token punctuation">,</span> <span class="token string">'讲师'</span> <span class="token punctuation">,</span> <span class="token string">'11-5月-1998'</span> <span class="token punctuation">,</span> <span class="token number">600</span> <span class="token punctuation">,</span> <span class="token number">2500</span> <span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> teachers<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10207</span> <span class="token punctuation">,</span> <span class="token string">'张珂'</span> <span class="token punctuation">,</span> <span class="token string">'讲师'</span> <span class="token punctuation">,</span> <span class="token string">'16-8月-1997'</span> <span class="token punctuation">,</span> <span class="token number">700</span> <span class="token punctuation">,</span> <span class="token number">2700</span> <span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> teachers<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10308</span> <span class="token punctuation">,</span> <span class="token string">'齐沈阳'</span> <span class="token punctuation">,</span> <span class="token string">'高工'</span> <span class="token punctuation">,</span> <span class="token string">'03-10月-1989'</span> <span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token punctuation">,</span> <span class="token number">3100</span> <span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> teachers<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10306</span> <span class="token punctuation">,</span> <span class="token string">'车东日'</span> <span class="token punctuation">,</span> <span class="token string">'助教'</span> <span class="token punctuation">,</span> <span class="token string">'05-9月-2001'</span> <span class="token punctuation">,</span> <span class="token number">500</span> <span class="token punctuation">,</span> <span class="token number">1900</span> <span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> teachers<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10309</span> <span class="token punctuation">,</span> <span class="token string">'臧海涛'</span> <span class="token punctuation">,</span> <span class="token string">'工程师'</span> <span class="token punctuation">,</span> <span class="token string">'29-6月-1999'</span> <span class="token punctuation">,</span> <span class="token number">600</span> <span class="token punctuation">,</span> <span class="token number">2400</span> <span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> teachers<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10307</span> <span class="token punctuation">,</span> <span class="token string">'赵昆'</span> <span class="token punctuation">,</span> <span class="token string">'讲师'</span> <span class="token punctuation">,</span> <span class="token string">'18-2月-1996'</span> <span class="token punctuation">,</span> <span class="token number">800</span> <span class="token punctuation">,</span> <span class="token number">2700</span> <span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> teachers<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10128</span> <span class="token punctuation">,</span> <span class="token string">'王晓'</span> <span class="token punctuation">,</span> <span class="token boolean">null</span> <span class="token punctuation">,</span> <span class="token string">'05-9月-2007'</span> <span class="token punctuation">,</span> <span class="token boolean">null</span> <span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> teachers<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10328</span> <span class="token punctuation">,</span> <span class="token string">'张笑'</span> <span class="token punctuation">,</span> <span class="token boolean">null</span> <span class="token punctuation">,</span> <span class="token string">'29-9月-2007'</span> <span class="token punctuation">,</span> <span class="token boolean">null</span> <span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> teachers<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10228</span> <span class="token punctuation">,</span> <span class="token string">'赵天宇'</span> <span class="token punctuation">,</span> <span class="token boolean">null</span> <span class="token punctuation">,</span> <span class="token string">'18-9月-2007'</span> <span class="token punctuation">,</span> <span class="token boolean">null</span> <span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class=" language-sql"><code class="language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> courses<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10101</span> <span class="token punctuation">,</span> <span class="token string">'计算机组成原理'</span> <span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> courses<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10201</span> <span class="token punctuation">,</span> <span class="token string">'自动控制原理'</span> <span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> courses<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10301</span> <span class="token punctuation">,</span> <span class="token string">'工程制图'</span> <span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> courses<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10102</span> <span class="token punctuation">,</span> <span class="token string">'C++语言程序设计'</span> <span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> courses<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10202</span> <span class="token punctuation">,</span> <span class="token string">'模拟电子技术'</span> <span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> courses<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10302</span> <span class="token punctuation">,</span> <span class="token string">'理论力学'</span> <span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> courses<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10103</span> <span class="token punctuation">,</span> <span class="token string">'离散数学'</span> <span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> courses<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10203</span> <span class="token punctuation">,</span> <span class="token string">'数字电子技术'</span> <span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> courses<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10303</span> <span class="token punctuation">,</span> <span class="token string">'材料力学'</span> <span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class=" language-sql"><code class="language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> student_grade<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10101</span> <span class="token punctuation">,</span> <span class="token number">10101</span> <span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> student_grade<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10101</span> <span class="token punctuation">,</span> <span class="token number">10201</span> <span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> student_grade<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10101</span> <span class="token punctuation">,</span> <span class="token number">10301</span> <span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class=" language-sql"><code class="language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> grades<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">,</span> <span class="token number">59</span> <span class="token punctuation">,</span> <span class="token string">'不及格'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> grades<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token punctuation">,</span> <span class="token number">60</span> <span class="token punctuation">,</span> <span class="token number">69</span> <span class="token punctuation">,</span> <span class="token string">'及格'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> grades<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">3</span> <span class="token punctuation">,</span> <span class="token number">70</span> <span class="token punctuation">,</span> <span class="token number">79</span> <span class="token punctuation">,</span> <span class="token string">'中等'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> grades<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">4</span> <span class="token punctuation">,</span> <span class="token number">80</span> <span class="token punctuation">,</span> <span class="token number">89</span> <span class="token punctuation">,</span> <span class="token string">'良好'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> grades<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">5</span> <span class="token punctuation">,</span> <span class="token number">90</span> <span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">,</span> <span class="token string">'优秀'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class=" language-sql"><code class="language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> minors<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10101</span> <span class="token punctuation">,</span> <span class="token string">'计算机组成原理'</span> <span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> minors<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10201</span> <span class="token punctuation">,</span> <span class="token string">'自动控制原理'</span> <span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> minors<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10301</span> <span class="token punctuation">,</span> <span class="token string">'工程制图'</span> <span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class=" language-sql"><code class="language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> courses2<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10201</span> <span class="token punctuation">,</span> <span class="token string">'自动控制原理'</span> <span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> courses2<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10301</span> <span class="token punctuation">,</span> <span class="token string">'工程制图'</span> <span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class=" language-sql"><code class="language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> student_computer       <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students                <span class="token keyword">where</span>                specialty <span class="token operator">=</span> <span class="token string">'计算机'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="表的三种基本操作"><a href="#表的三种基本操作" class="headerlink" title="表的三种基本操作"></a>表的三种基本操作</h2><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students<span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> departments<span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> teachers<span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> courses<span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student_grade<span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> grades<span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> minors<span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> courses2<span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student_computer<span class="token punctuation">;</span></code></pre><ul><li>查看指定表中的所有行所有列的数据<ul><li><code>*</code> 星号表示检索所有的列</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">delete</span> <span class="token keyword">from</span> students<span class="token punctuation">;</span><span class="token keyword">delete</span> <span class="token keyword">from</span> departments<span class="token punctuation">;</span><span class="token keyword">delete</span> <span class="token keyword">from</span> teachers<span class="token punctuation">;</span><span class="token keyword">delete</span> <span class="token keyword">from</span> courses<span class="token punctuation">;</span><span class="token keyword">delete</span> <span class="token keyword">from</span> student_grade<span class="token punctuation">;</span><span class="token keyword">delete</span> <span class="token keyword">from</span> grades<span class="token punctuation">;</span><span class="token keyword">delete</span> <span class="token keyword">from</span> minors<span class="token punctuation">;</span><span class="token keyword">delete</span> <span class="token keyword">from</span> courses2<span class="token punctuation">;</span><span class="token keyword">delete</span> <span class="token keyword">from</span> stduent_computer<span class="token punctuation">;</span></code></pre><ul><li>删除指定表中的全部数据</li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">drop</span> <span class="token keyword">table</span> students<span class="token punctuation">;</span><span class="token keyword">drop</span> <span class="token keyword">table</span> departments<span class="token punctuation">;</span><span class="token keyword">drop</span> <span class="token keyword">table</span> teachers<span class="token punctuation">;</span><span class="token keyword">drop</span> <span class="token keyword">table</span> courses<span class="token punctuation">;</span><span class="token keyword">drop</span> <span class="token keyword">table</span> student_grade<span class="token punctuation">;</span><span class="token keyword">drop</span> <span class="token keyword">table</span> grades<span class="token punctuation">;</span><span class="token keyword">drop</span> <span class="token keyword">table</span> minors<span class="token punctuation">;</span><span class="token keyword">drop</span> <span class="token keyword">table</span> courses2<span class="token punctuation">;</span><span class="token keyword">drop</span> <span class="token keyword">table</span> student_computer<span class="token punctuation">;</span></code></pre><ul><li>删除指定的整张表<ul><li>特殊删除顺序：先删除从表再删除主表</li></ul></li></ul><h2 id="数据操纵语言（DML）"><a href="#数据操纵语言（DML）" class="headerlink" title="数据操纵语言（DML）"></a>数据操纵语言（DML）</h2><ul><li>insert(增)</li><li>delete(删)</li><li>uodate(改)</li><li>以事务为单位，一个事务为一个工作的逻辑单位，是一个 SQL 语句序列</li><li>执行每一个 DML 语句，所有的操作都在内存中完成</li><li>执行完一系列 DML 语句后，需要决定由DML语句所做的修改是<ul><li>全部或部分地保留到硬盘文件上</li><li>还是全部撤销</li><li>这些决定由事务处理语句来完成<ul><li>commit（提交）</li><li>savepoint（保留点）</li><li>rollback（撤销）<ul><li>事务被用来确保数据库中数据的一致性</li><li>要么全部成功</li><li>要么全部取消</li></ul></li></ul></li><li>数据库事务开始于应用程序中的第一条 DLM 语句</li><li>数据库事务开始后：<ul><li>Oracle 会为 DLM 操作涉及的表加上表锁<ul><li>防止其他用户改变表结构</li></ul></li><li>Oracle 会为 DLM 操作涉及的行加上行锁<ul><li>防止其他事务在相应的行上执行 DML 操作</li></ul></li></ul></li><li>数据库事务结束后，释放封锁（表锁和行锁）</li></ul></li></ul><ul><li>insert<ul><li>数字列，直接提供数值</li><li>字符列，<code>&#39;&#39;</code>英文单引号</li><li>日期列，<code>&#39;&#39;</code>英文单引号</li><li>提供数据的顺序问题<ul><li>或与表中列的顺序完全一致</li><li>或与提供的列表中的列名顺序一致</li></ul></li><li>必须为主键和 not null 提供数据<ul><li>未指定列的值<ul><li>或 null（可显示处理）</li><li>或 default（可显示处理）</li></ul></li></ul></li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">update</span> students <span class="token keyword">set</span>       student_id <span class="token operator">=</span> <span class="token number">11111</span>       <span class="token keyword">where</span>       student_id <span class="token operator">=</span> <span class="token number">10228</span><span class="token punctuation">;</span><span class="token keyword">update</span> students <span class="token keyword">set</span>       specialty <span class="token operator">=</span> <span class="token string">'计算机应用'</span>       <span class="token keyword">where</span>       specialty <span class="token operator">=</span> <span class="token string">'计算机'</span><span class="token punctuation">;</span><span class="token keyword">update</span> students <span class="token keyword">set</span>       dob <span class="token operator">=</span> <span class="token string">'11-1月-1111'</span>       <span class="token keyword">where</span>       student_id <span class="token operator">=</span> <span class="token number">11111</span><span class="token punctuation">;</span><span class="token keyword">update</span> students <span class="token keyword">set</span>       specialty <span class="token operator">=</span> <span class="token boolean">null</span>       <span class="token keyword">where</span>       student_id <span class="token operator">=</span> <span class="token number">11111</span><span class="token punctuation">;</span><span class="token keyword">update</span> teachers <span class="token keyword">set</span>       wage <span class="token operator">=</span> wage <span class="token operator">*</span> <span class="token number">1.1</span> <span class="token punctuation">,</span>       bonus <span class="token operator">=</span> bonus <span class="token operator">+</span> <span class="token number">1000</span>       <span class="token keyword">where</span>       title <span class="token operator">=</span> <span class="token string">'教授'</span><span class="token punctuation">;</span></code></pre><ul><li>update<ul><li>数字列，直接提供数值</li><li>字符列，<code>&#39;&#39;</code>英文单引号</li><li>日期列，<code>&#39;&#39;</code>英文单引号</li><li>使用 where ，修改指定行</li><li>不使用 where ，修改所有行</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">delete</span> <span class="token keyword">from</span> students       <span class="token keyword">where</span>        specialty <span class="token operator">=</span> <span class="token string">'计算机应用'</span><span class="token punctuation">;</span></code></pre><ul><li>delete<ul><li>where ，删除指定行</li><li>不使用 where ，删除所有行</li><li>不会释放表所占空间，操作可以撤销（rollback）</li></ul></li><li>truncate table<ul><li><code>truncate table table_name</code></li><li>会释放表所占空间</li><li>操作不可撤销</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> student_computer       <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students                <span class="token keyword">where</span>                specialty <span class="token operator">=</span> <span class="token string">'计算机'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ul><li>含有子查询的 DML 之 insert 语句</li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">update</span> teachers <span class="token keyword">set</span>        bonus <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>bonus<span class="token punctuation">)</span> <span class="token keyword">from</span> teachers<span class="token punctuation">)</span>       <span class="token keyword">where</span>        bonus <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span></code></pre><ul><li>含有子查询的 DML 之 update 语句</li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">delete</span> <span class="token keyword">from</span> teachers       <span class="token keyword">where</span>        wage <span class="token operator">></span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token number">1.1</span> <span class="token operator">*</span> <span class="token function">avg</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token keyword">from</span> teachers<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ul><li>含有子查询的 DML 之 delete 语句</li></ul><h2 id="数据库的完整性"><a href="#数据库的完整性" class="headerlink" title="数据库的完整性"></a>数据库的完整性</h2><ul><li>实体完整性：<ul><li>表的主键不能为空值 null</li><li>表的主键不能取重复值</li></ul></li></ul><ul><li><p>参照完整性</p><ul><li>teachers 表</li><li>通过 department_id 列与</li><li>departments 表</li><li>建立了参照完整性<ul><li>从表 teachers</li><li>主表 departments</li></ul></li><li>从表 teachers 中的 department_id 只能取<ul><li>或 null 值</li><li>或 departments 主表中的 department_id 值</li></ul></li></ul></li><li><p>违反参照完整性约束规则：</p><ul><li><p>1、</p><pre class=" language-sql"><code class="language-sql"><span class="token keyword">delete</span> <span class="token keyword">from</span> departments       <span class="token keyword">where</span>        department_id <span class="token operator">=</span> <span class="token number">101</span><span class="token punctuation">;</span></code></pre><ul><li>主表要删除的 department_id ，从表中存在</li></ul></li><li><p>2、</p><pre class=" language-sql"><code class="language-sql"><span class="token keyword">update</span> departments <span class="token keyword">set</span>        department_id <span class="token operator">=</span> <span class="token number">105</span>        <span class="token keyword">where</span>        department_id <span class="token operator">=</span> <span class="token number">102</span><span class="token punctuation">;</span></code></pre><ul><li>主表要修改的 department_id ，从表中存在</li></ul></li><li><p>3、</p><pre class=" language-sql"><code class="language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> teachers <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ul><li>从表中插入的 department_id ，主表中无</li></ul></li><li><p>4、</p><pre class=" language-sql"><code class="language-sql"><span class="token keyword">update</span> teachers <span class="token keyword">set</span>        department_id <span class="token operator">=</span> <span class="token number">107</span>       <span class="token keyword">where</span>        teacher_id <span class="token operator">=</span> <span class="token number">10106</span><span class="token punctuation">;</span></code></pre><ul><li>从表要修改的 department_id ，主表中无</li></ul></li></ul></li></ul><ul><li><p>自定义完整性</p><ul><li><p>1、</p><ul><li>例如插入学生记录时，没有给出姓名值</li><li>违反了 not null 自定义完整性约束</li></ul></li><li><p>2、</p><pre class=" language-sql"><code class="language-sql"><span class="token keyword">update</span> student <span class="token keyword">set</span>       sex <span class="token operator">=</span> <span class="token string">'南'</span>        <span class="token keyword">where</span>        student_id <span class="token operator">=</span> <span class="token number">10205</span><span class="token punctuation">;</span></code></pre><ul><li>违反了 check 自定义完整性约束（只能取‘男’或‘女’）</li></ul></li></ul></li></ul><h2 id="事务处理"><a href="#事务处理" class="headerlink" title="事务处理"></a>事务处理</h2><ul><li>commit<ul><li>（显示处理事务）提交事务</li><li>结束当前事务</li><li>把当前事务所执行的全部修改保存到外存的数据库中</li><li>删除事务的所有保留点</li><li>释放该事务的封锁</li></ul></li></ul><ul><li>rollback<ul><li>（显示处理事务）撤销事务</li><li>结束当前事务</li><li>撤销当前事务中所做的全部修改</li><li>删除当前事务中所建的全部保留点</li><li>释放该事务的封锁</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">update</span> departments <span class="token keyword">set</span>       address <span class="token operator">=</span> <span class="token string">'5号教学楼'</span>       <span class="token keyword">where</span>        department_id <span class="token operator">=</span> <span class="token number">104</span><span class="token punctuation">;</span><span class="token keyword">savepoint</span> sp1<span class="token punctuation">;</span><span class="token keyword">delete</span> <span class="token keyword">from</span> departments        <span class="token keyword">where</span>        department_id <span class="token operator">=</span> <span class="token number">104</span><span class="token punctuation">;</span><span class="token keyword">rollback</span> <span class="token keyword">to</span> sp1<span class="token punctuation">;</span></code></pre><ul><li>savepoint<ul><li>rollback to sp1<ul><li>撤销保留点 sp1 之后的全部事务</li><li>删除保留点 sp1 之后的全部保留点</li></ul></li></ul></li></ul><ul><li>隐式处理事务：<ul><li>执行 create table 、alter table 、drop table 等语句时<ul><li>Oracle 系统自动提交 commit 事务</li></ul></li><li>执行 exit（正常）退出 SQL*Plus 时<ul><li>Oracle 系统自动提交 commit 事务</li></ul></li><li>当意外（非正常）退出 SQL*Plus 时<ul><li>Oracle 系统自动撤销 rollback 事务</li></ul></li></ul></li></ul><ul><li><code>set transaction read only</code><ul><li>（特殊事务）只读事务</li><li>只允许查询语句</li><li>不允许执行 DML 语句</li><li>可以取得特定时间点的数据</li><li>该命令必须为事务的第一条语句</li><li>必须由 commit 、rollback 语句来结束只读事务</li></ul></li></ul><h2 id="简单查询"><a href="#简单查询" class="headerlink" title="简单查询"></a>简单查询</h2><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> name <span class="token punctuation">,</span> hire_date <span class="token keyword">from</span> teachers<span class="token punctuation">;</span><span class="token keyword">select</span> name <span class="token punctuation">,</span> to_char<span class="token punctuation">(</span>hire_date<span class="token punctuation">,</span><span class="token string">'yyyy-mm-dd'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> teachers<span class="token punctuation">;</span></code></pre><ul><li>查询指定列，多列需用英文逗号隔开</li><li>日期数据的默认格式可以用“to_char”转换成其他显示格式</li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> specialty <span class="token keyword">from</span> students<span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token keyword">distinct</span> specialty <span class="token keyword">from</span> students<span class="token punctuation">;</span></code></pre><ul><li><code>distinct</code><ul><li>（明显的、有区别的）</li><li>消除完全重复的记录行（当选择主键以外的列执行查询操作时）</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> name <span class="token keyword">as</span> <span class="token string">"姓名"</span> <span class="token punctuation">,</span> dob <span class="token keyword">as</span> <span class="token string">"生日"</span> <span class="token keyword">from</span> students<span class="token punctuation">;</span></code></pre><ul><li>列别名<ul><li><code>as + &quot;......&quot;</code></li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> name <span class="token operator">||</span> <span class="token string">'生日是：'</span> <span class="token operator">||</span> dob <span class="token keyword">as</span> <span class="token string">"学生生日清单"</span> <span class="token keyword">from</span> students<span class="token punctuation">;</span></code></pre><ul><li><code>||</code><ul><li>字符串连接</li><li>连接的字符串要使用英文单引号 <code>&#39;&#39;</code></li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> name <span class="token keyword">as</span> <span class="token string">"姓名"</span> <span class="token punctuation">,</span> bonus<span class="token operator">+</span>wage <span class="token keyword">as</span> <span class="token string">"月总收入"</span> <span class="token keyword">from</span> teachers<span class="token punctuation">;</span></code></pre><ul><li>算术表达式<ul><li>使用括号可以改变运算次序</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> name <span class="token keyword">as</span> <span class="token string">"姓名"</span> <span class="token punctuation">,</span> nvl<span class="token punctuation">(</span>bonus <span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span>wage <span class="token keyword">as</span> <span class="token string">"月总收入"</span> <span class="token keyword">from</span> teachers<span class="token punctuation">;</span><span class="token keyword">select</span> name <span class="token keyword">as</span> <span class="token string">"姓名"</span> <span class="token punctuation">,</span> nvl2<span class="token punctuation">(</span>bonus <span class="token punctuation">,</span> bonus<span class="token operator">+</span>wage <span class="token punctuation">,</span> wage<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">"月总收入"</span>        <span class="token keyword">from</span> teachers<span class="token punctuation">;</span><span class="token keyword">select</span> name <span class="token keyword">as</span> <span class="token string">"姓名"</span> <span class="token punctuation">,</span> <span class="token keyword">coalesce</span><span class="token punctuation">(</span>bonus<span class="token operator">+</span>wage <span class="token punctuation">,</span> wage<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">"月总收入"</span>        <span class="token keyword">from</span> teachers<span class="token punctuation">;</span></code></pre><ul><li>任何数据类型的列<ul><li>只要没有使用非空 not null 或主键 primary key 完整性约束</li><li>就都有可能出现空值 null</li><li>空值 null 没有数据类型</li><li>空值 null 出现在字符串连接表达式中，Oracle 将其作为空串处理</li><li>空值 null 出现在算术表达式中，运算结果为 null</li><li>为了解决空值 null 参加运算时出现的问题，Oracle 提供了3个函数对此进行处理</li><li>nvl（A , B）<br>​   - A 、B 的数据类型必须匹配<br>​   - A 为 null ，返回 B<br>​   - A 不为 null ，返回 A</li><li>nvl2（A ，B ，C）<br>​   - A 、B 、C 的数据类型必须匹配<br>​   - A 为 null ,返回 C<br>​   - A 不为 null ，返回 B</li><li>coalesce（A、B、C、D…）<br>​   - 联合，合并<br>​   - 返回参数列表中的第一个非空值<br>​   - 若参数列表皆为空值，最终返回一个空值 null</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> name <span class="token punctuation">,</span> hire_date <span class="token punctuation">,</span> title <span class="token punctuation">,</span> wage <span class="token keyword">from</span> teachers        <span class="token keyword">where</span>        wage <span class="token operator">>=</span> <span class="token number">2000</span><span class="token punctuation">;</span><span class="token keyword">select</span> student_id <span class="token punctuation">,</span> name <span class="token punctuation">,</span> specialty <span class="token punctuation">,</span> dob <span class="token keyword">from</span> students       <span class="token keyword">where</span>        specialty <span class="token operator">=</span> <span class="token string">'计算机'</span><span class="token punctuation">;</span><span class="token keyword">select</span> student_id <span class="token punctuation">,</span> name <span class="token punctuation">,</span> specialty <span class="token punctuation">,</span> dob <span class="token keyword">from</span> students       <span class="token keyword">where</span>        dob <span class="token operator">&lt;</span> <span class="token string">'1-1月-1990'</span><span class="token punctuation">;</span></code></pre><ul><li>算术运算比较符<code>= 、&lt; 、&lt;= 、&gt; 、&gt;= 、 &lt;&gt;(!=)</code></li></ul><h2 id="条件查询"><a href="#条件查询" class="headerlink" title="条件查询"></a>条件查询</h2><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> name <span class="token punctuation">,</span> hire_date <span class="token punctuation">,</span> title <span class="token punctuation">,</span> bonus <span class="token keyword">from</span> teachers       <span class="token keyword">where</span>        bonus <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">500</span> <span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">select</span> student_id <span class="token punctuation">,</span> name <span class="token punctuation">,</span> specialty <span class="token punctuation">,</span> dob <span class="token keyword">from</span> students       <span class="token keyword">where</span>        dob <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token string">'26-12月-1989'</span> <span class="token punctuation">,</span> <span class="token string">'08-10月-1990'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ul><li>包含测试 <code>in</code></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> name <span class="token punctuation">,</span> hire_date <span class="token punctuation">,</span> title <span class="token punctuation">,</span> bonus <span class="token keyword">from</span> teachers       <span class="token keyword">where</span>        bonus <span class="token operator">between</span> <span class="token number">500</span> <span class="token operator">and</span> <span class="token number">1500</span><span class="token punctuation">;</span></code></pre><ul><li>范围测试 <code>between-and</code></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> student_id <span class="token punctuation">,</span> name <span class="token punctuation">,</span> specialty <span class="token punctuation">,</span>dob <span class="token keyword">from</span> students       <span class="token keyword">where</span>        name <span class="token operator">like</span> <span class="token string">'王%'</span><span class="token punctuation">;</span><span class="token keyword">select</span> student_id <span class="token punctuation">,</span> name <span class="token punctuation">,</span> specialty <span class="token punctuation">,</span>dob <span class="token keyword">from</span> students       <span class="token keyword">where</span>        name <span class="token operator">like</span> <span class="token string">'王_'</span><span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students<span class="token punctuation">;</span></code></pre><ul><li>匹配测试 <code>like</code><ul><li>通配符 <code>%（百分号）</code>表示0或多个字符</li><li>通配符 <code>_（下划线）</code>表示单个字符</li><li>通配符只用于 like 条件</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> name <span class="token punctuation">,</span> hire_date <span class="token punctuation">,</span> title <span class="token punctuation">,</span>bonus <span class="token keyword">from</span> teachers       <span class="token keyword">where</span>        bonus <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span><span class="token keyword">select</span> name <span class="token punctuation">,</span> hire_date <span class="token punctuation">,</span> title <span class="token punctuation">,</span>bonus <span class="token keyword">from</span> teachers       <span class="token keyword">where</span>        title <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span><span class="token keyword">select</span> student_id <span class="token punctuation">,</span> name <span class="token punctuation">,</span> specialty <span class="token punctuation">,</span>dob <span class="token keyword">from</span> students       <span class="token keyword">where</span>        dob <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span></code></pre><ul><li>空值测试 <code>is null</code><ul><li>不可写成 = null</li><li>因为 null 是一个未知或未确定的数据</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> student_id <span class="token punctuation">,</span> name <span class="token punctuation">,</span> sex <span class="token punctuation">,</span> specialty <span class="token keyword">from</span> students       <span class="token keyword">where</span>        specialty <span class="token operator">=</span> <span class="token string">'计算机'</span> <span class="token operator">and</span> sex <span class="token operator">=</span> <span class="token string">'男'</span><span class="token punctuation">;</span><span class="token keyword">select</span> student_id <span class="token punctuation">,</span> name <span class="token punctuation">,</span> sex <span class="token punctuation">,</span> specialty <span class="token keyword">from</span> students       <span class="token keyword">where</span>        specialty <span class="token operator">=</span> <span class="token string">'计算机'</span> <span class="token operator">or</span> specialty <span class="token operator">=</span> <span class="token string">'自动化'</span><span class="token punctuation">;</span><span class="token keyword">select</span> student_id <span class="token punctuation">,</span> name <span class="token punctuation">,</span> sex <span class="token punctuation">,</span> specialty <span class="token keyword">from</span> students       <span class="token keyword">where</span>        <span class="token operator">not</span> specialty <span class="token operator">=</span> <span class="token string">'计算机'</span><span class="token punctuation">;</span><span class="token keyword">select</span> student_id <span class="token punctuation">,</span> name <span class="token punctuation">,</span>specialty <span class="token punctuation">,</span> dob <span class="token keyword">from</span> students       <span class="token keyword">where</span>        dob <span class="token operator">not</span> <span class="token operator">between</span> <span class="token string">'1-1月-1989'</span> <span class="token operator">and</span> <span class="token string">'1-1月-1990'</span><span class="token punctuation">;</span><span class="token keyword">select</span> student_id <span class="token punctuation">,</span> name <span class="token punctuation">,</span>specialty <span class="token punctuation">,</span> dob <span class="token keyword">from</span> students       <span class="token keyword">where</span>        name <span class="token operator">not</span> <span class="token operator">like</span> <span class="token string">'张%'</span><span class="token punctuation">;</span><span class="token keyword">select</span> student_id <span class="token punctuation">,</span> name <span class="token punctuation">,</span>specialty <span class="token punctuation">,</span> dob <span class="token keyword">from</span> students       <span class="token keyword">where</span>        name <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token string">'欧阳春岚'</span> <span class="token punctuation">,</span> <span class="token string">'高山'</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token keyword">select</span> name <span class="token punctuation">,</span> hire_date <span class="token punctuation">,</span> title <span class="token punctuation">,</span>bonus <span class="token keyword">from</span> teachers       <span class="token keyword">where</span>        bonus <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span></code></pre><ul><li>where 子句的复合条件查询涉及逻辑运算符<ul><li>and 、or 为双操作数逻辑运算符</li><li>not 为单操作数逻辑运算符</li><li>not 主要与 = 、between-and 、like 、in 以及 is null 结合使用</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> student_id <span class="token punctuation">,</span> name <span class="token punctuation">,</span> sex <span class="token punctuation">,</span> specialty <span class="token keyword">from</span> students       <span class="token keyword">where</span>       specialty <span class="token operator">=</span> <span class="token string">'计算机'</span> <span class="token operator">and</span> sex <span class="token operator">=</span> <span class="token string">'女'</span>       <span class="token operator">or</span>       specialty <span class="token operator">=</span> <span class="token string">'机电工程'</span> <span class="token operator">and</span> sex <span class="token operator">=</span> <span class="token string">'男'</span><span class="token punctuation">;</span><span class="token keyword">select</span> name <span class="token punctuation">,</span> hire_date <span class="token punctuation">,</span> title <span class="token punctuation">,</span> bonus <span class="token punctuation">,</span> wage <span class="token keyword">from</span> teachers       <span class="token keyword">where</span>       <span class="token operator">not</span> title <span class="token operator">=</span> <span class="token string">'工程师'</span>       <span class="token operator">and</span>       hire_date <span class="token operator">&lt;</span> <span class="token string">'1-1月-2002'</span>       <span class="token operator">and</span>       wage <span class="token operator">&lt;</span> <span class="token number">3000</span><span class="token punctuation">;</span></code></pre><ul><li>组合使用逻辑条件<ul><li>not &gt;  and &gt;  or </li><li>括号可以改变优先级</li></ul></li></ul><h2 id="记录排序"><a href="#记录排序" class="headerlink" title="记录排序"></a>记录排序</h2><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> name <span class="token punctuation">,</span> hire_date <span class="token punctuation">,</span> title <span class="token punctuation">,</span> bonus <span class="token punctuation">,</span> wage <span class="token keyword">from</span> teachers       <span class="token keyword">order</span> <span class="token keyword">by</span> wage <span class="token keyword">asc</span><span class="token punctuation">;</span><span class="token keyword">select</span> name <span class="token punctuation">,</span> hire_date <span class="token punctuation">,</span> title <span class="token punctuation">,</span> bonus <span class="token punctuation">,</span> wage <span class="token keyword">from</span> teachers       <span class="token keyword">order</span> <span class="token keyword">by</span> wage<span class="token punctuation">;</span></code></pre><ul><li><code>asc</code><ul><li>指定进行升序排序</li><li>asc 可省略</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> name <span class="token keyword">as</span> <span class="token string">"姓名"</span> <span class="token punctuation">,</span> dob <span class="token keyword">as</span> <span class="token string">"出生日期"</span> <span class="token keyword">from</span> students       <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token string">"出生日期"</span> <span class="token keyword">desc</span><span class="token punctuation">;</span><span class="token keyword">select</span> student_id <span class="token punctuation">,</span> name <span class="token punctuation">,</span> specialty <span class="token punctuation">,</span> dob <span class="token keyword">from</span> students       <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">2</span> <span class="token keyword">desc</span><span class="token punctuation">;</span></code></pre><ul><li><code>desc</code> <ul><li>指定进行降序排序</li><li>desc 不可省略</li><li>所指定的排序列包含 null 值的记录行会排列在最前面</li><li>可以使用列别名进行排序</li><li>如果列名或表达式名称较长，可以使用列位置序号排序</li><li>汉字排序按其拼音对应的英文字母的顺序进行</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> student_id <span class="token punctuation">,</span> name <span class="token punctuation">,</span> specialty <span class="token punctuation">,</span> dob <span class="token keyword">from</span> students       <span class="token keyword">order</span> <span class="token keyword">by</span> specialty <span class="token punctuation">,</span> name <span class="token keyword">asc</span><span class="token punctuation">;</span><span class="token keyword">select</span> student_id <span class="token punctuation">,</span> name <span class="token punctuation">,</span> specialty <span class="token punctuation">,</span> dob <span class="token keyword">from</span> students       <span class="token keyword">order</span> <span class="token keyword">by</span> specialty <span class="token punctuation">,</span> name <span class="token keyword">desc</span><span class="token punctuation">;</span></code></pre><ul><li>多列排序<ul><li>先按指定的第一个列进行排序</li><li>再按指定的第二个列进行排序</li><li>依次类推</li></ul></li></ul><h2 id="分组查询"><a href="#分组查询" class="headerlink" title="分组查询"></a>分组查询</h2><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token keyword">from</span> teachers<span class="token punctuation">;</span></code></pre><ul><li>avg()<ul><li>列函数</li><li>用于计算列或表达式的平均值</li><li>只适用于数值型数据</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> students<span class="token punctuation">;</span></code></pre><ul><li>count(*)<ul><li>列函数</li><li>用于取得指定表的记录总行数</li><li>除 count(*) 外其他列函数都不考虑 null 行</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>dob<span class="token punctuation">)</span> <span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span>dob<span class="token punctuation">)</span> <span class="token keyword">from</span> students<span class="token punctuation">;</span></code></pre><ul><li>max()<ul><li>列函数</li><li>用于求出列或表达式的最大值</li><li>适用于任何数据类型</li></ul></li><li>min()<ul><li>列函数</li><li>用于求出列或表达式的最小值</li><li>适用于任何数据类型</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token function">sum</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token keyword">from</span> teachers<span class="token punctuation">;</span></code></pre><ul><li>sum()<ul><li>列函数</li><li>用于对列或表达式求总和</li><li>只适用于数值型数据</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> variance<span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token keyword">from</span> teachers<span class="token punctuation">;</span></code></pre><ul><li>variance()<ul><li>列函数</li><li>用于求出列或表达式的方差</li><li>只适用于数值型数据</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> stddev<span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token keyword">from</span> teachers<span class="token punctuation">;</span></code></pre><ul><li>stddev()<ul><li>列函数</li><li>用于求出列或表达式的标准偏差</li><li>只适用于数值型数据</li><li>当只有一行数据时，stddev() 返回0</li><li>当存在多行数据时，stddev() 按照 variance() 值的平方根来计算标准偏差</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> department_id <span class="token keyword">from</span> teachers       <span class="token keyword">group</span> <span class="token keyword">by</span> department_id<span class="token punctuation">;</span><span class="token keyword">select</span> department_id <span class="token punctuation">,</span> title <span class="token keyword">from</span> teachers       <span class="token keyword">group</span> <span class="token keyword">by</span> department_id <span class="token punctuation">,</span> title<span class="token punctuation">;</span><span class="token keyword">select</span> department_id <span class="token punctuation">,</span> <span class="token function">max</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token keyword">from</span> teachers       <span class="token keyword">group</span> <span class="token keyword">by</span> department_id<span class="token punctuation">;</span><span class="token keyword">select</span> department_id <span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token keyword">from</span> teachers       <span class="token keyword">group</span> <span class="token keyword">by</span> department_id<span class="token punctuation">;</span><span class="token keyword">select</span> department_id <span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> teachers       <span class="token keyword">group</span> <span class="token keyword">by</span> department_id<span class="token punctuation">;</span><span class="token keyword">select</span> department_id <span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token keyword">from</span> teachers       <span class="token keyword">where</span>        wage <span class="token operator">></span> <span class="token number">1000</span>       <span class="token keyword">group</span> <span class="token keyword">by</span> department_id<span class="token punctuation">;</span></code></pre><ul><li><code>group by</code><ul><li>用于分组，组中的行并不互相重复</li><li>可以单独使用</li></ul></li></ul><pre class=" language-sql"><code class="language-sql"><span class="token keyword">select</span> department_id <span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token keyword">from</span> teachers       <span class="token keyword">group</span> <span class="token keyword">by</span> department_id       <span class="token keyword">having</span> <span class="token function">avg</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">2200</span><span class="token punctuation">;</span><span class="token keyword">select</span> department_id <span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token keyword">from</span> teachers       <span class="token keyword">where</span>        wage <span class="token operator">&lt;</span> <span class="token number">3000</span>       <span class="token keyword">group</span> <span class="token keyword">by</span> department_id       <span class="token keyword">having</span> <span class="token function">avg</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">2000</span><span class="token punctuation">;</span><span class="token keyword">select</span> department_id <span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token keyword">from</span> teachers       <span class="token keyword">where</span>        wage <span class="token operator">&lt;</span> <span class="token number">3000</span>       <span class="token keyword">group</span> <span class="token keyword">by</span> department_id       <span class="token keyword">having</span> <span class="token function">avg</span><span class="token punctuation">(</span>wage<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">2000</span>       <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">2</span><span class="token punctuation">;</span></code></pre><ul><li><p><code>having</code></p><ul><li><p>指定条件，用于限制分组显示结果</p></li><li><p>having 必须与 group by 一起使用</p></li></ul></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Database </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Sense of Beauty</title>
      <link href="/2018/09/30/Sense-of-Beauty/"/>
      <url>/2018/09/30/Sense-of-Beauty/</url>
      
        <content type="html"><![CDATA[<p><img src="http://wx3.sinaimg.cn/mw690/0060lm7Tly1fvqyk8u5bpj30ia0rf0ul.jpg" alt="wallhaven-334802"></p><ul><li><a href="https://alpha.wallhaven.cc/" target="_blank" rel="noopener"><strong><font size="5">推荐一个超级好用的摄影后期素材网站(个人最爱)</font><br> </strong></a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Photograph </tag>
            
            <tag> Aesthetic Perception </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hello World</title>
      <link href="/2018/09/29/hello-world/"/>
      <url>/2018/09/29/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class=" language-bash"><code class="language-bash">$ hexo new <span class="token string">"My New Post"</span></code></pre><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class=" language-bash"><code class="language-bash">$ hexo server</code></pre><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class=" language-bash"><code class="language-bash">$ hexo generate</code></pre><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre class=" language-bash"><code class="language-bash">$ hexo deploy</code></pre><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> For Free </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
